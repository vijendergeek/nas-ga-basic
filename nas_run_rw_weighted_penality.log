Using device: cpu
Files already downloaded and verified
Files already downloaded and verified
Starting with 5 Population:
[Arch(conv=1, acc=0.0000), Arch(conv=2, acc=0.0000), Arch(conv=1, acc=0.0000), Arch(conv=3, acc=0.0000), Arch(conv=4, acc=0.0000)]


============================================================
Generation 1/3
============================================================
Evaluating architecture 1/5... --------------------------------------------------------------------------------
Total Conv Params: 16,128
Total FC Params: 8,394,250

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.4190
Original Complexity Penalty: 8.3962
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0840
Original Fitness: 0.3350
Weighted Complexity Penalty: 1.0019
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0100
Modified Fitness(Weighted Complexity Penalty) : 0.4090
--------------------------------------------------------------------------------
Fitness: 0.4090, Accuracy: 0.4190
Evaluating architecture 2/5... --------------------------------------------------------------------------------
Total Conv Params: 2,804,000
Total FC Params: 525,002

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.3560
Original Complexity Penalty: 0.6375
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0064
Original Fitness: 0.3496
Weighted Complexity Penalty: 1.8423
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0184
Modified Fitness(Weighted Complexity Penalty) : 0.3376
--------------------------------------------------------------------------------
Fitness: 0.3376, Accuracy: 0.3560
Evaluating architecture 3/5... --------------------------------------------------------------------------------
Total Conv Params: 8,064
Total FC Params: 1,049,994

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.4020
Original Complexity Penalty: 1.0510
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0105
Original Fitness: 0.3915
Weighted Complexity Penalty: 1.0076
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0101
Modified Fitness(Weighted Complexity Penalty) : 0.3919
--------------------------------------------------------------------------------
Fitness: 0.3919, Accuracy: 0.4020
Evaluating architecture 4/5... --------------------------------------------------------------------------------
Total Conv Params: 40,915,712
Total FC Params: 525,002

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.3510
Original Complexity Penalty: 1.4860
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0149
Original Fitness: 0.3361
Weighted Complexity Penalty: 1.9873
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0199
Modified Fitness(Weighted Complexity Penalty) : 0.3311
--------------------------------------------------------------------------------
Fitness: 0.3311, Accuracy: 0.3510
Evaluating architecture 5/5... --------------------------------------------------------------------------------
Total Conv Params: 791,136
Total FC Params: 2,102,794

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.4370
Original Complexity Penalty: 2.1375
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0214
Original Fitness: 0.4156
Weighted Complexity Penalty: 1.2734
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0127
Modified Fitness(Weighted Complexity Penalty) : 0.4243
--------------------------------------------------------------------------------
Fitness: 0.4243, Accuracy: 0.4370

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=4, acc=0.4370)

Best overall: Arch(conv=4, acc=0.4370)

Performing roulette-wheel of total population: 5 ...

Roulette-Wheel Selection Probabilities:
Architecture 1: Original Fitness = 0.4243, Shifted Fitness = 0.4243, Probability = 0.2240
Architecture 2: Original Fitness = 0.4090, Shifted Fitness = 0.4090, Probability = 0.2159
Architecture 3: Original Fitness = 0.3919, Shifted Fitness = 0.3919, Probability = 0.2069
Architecture 4: Original Fitness = 0.3376, Shifted Fitness = 0.3376, Probability = 0.1782
Architecture 5: Original Fitness = 0.3311, Shifted Fitness = 0.3311, Probability = 0.1748

Selected 5 architectures using Roulette-Wheel selection
Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=4, acc=0.4370), Arch(conv=1, acc=0.4190), Arch(conv=4, acc=0.0000), Arch(conv=2, acc=0.0000), Arch(conv=4, acc=0.0000)]

============================================================
Generation 2/3
============================================================
Evaluating architecture 1/5... --------------------------------------------------------------------------------
Total Conv Params: 791,136
Total FC Params: 2,102,794

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.4540
Original Complexity Penalty: 2.1375
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0214
Original Fitness: 0.4326
Weighted Complexity Penalty: 1.2734
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0127
Modified Fitness(Weighted Complexity Penalty) : 0.4413
--------------------------------------------------------------------------------
Fitness: 0.4413, Accuracy: 0.4540
Evaluating architecture 2/5... --------------------------------------------------------------------------------
Total Conv Params: 16,128
Total FC Params: 8,394,250

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.4130
Original Complexity Penalty: 8.3962
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0840
Original Fitness: 0.3290
Weighted Complexity Penalty: 1.0019
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0100
Modified Fitness(Weighted Complexity Penalty) : 0.4030
--------------------------------------------------------------------------------
Fitness: 0.4030, Accuracy: 0.4130
Evaluating architecture 3/5... --------------------------------------------------------------------------------
Total Conv Params: 791,136
Total FC Params: 2,102,794

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.4400
Original Complexity Penalty: 2.1375
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0214
Original Fitness: 0.4186
Weighted Complexity Penalty: 1.2734
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0127
Modified Fitness(Weighted Complexity Penalty) : 0.4273
--------------------------------------------------------------------------------
Fitness: 0.4273, Accuracy: 0.4400
Evaluating architecture 4/5... --------------------------------------------------------------------------------
Total Conv Params: 2,804,000
Total FC Params: 525,002

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.3900
Original Complexity Penalty: 0.6375
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0064
Original Fitness: 0.3836
Weighted Complexity Penalty: 1.8423
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0184
Modified Fitness(Weighted Complexity Penalty) : 0.3716
--------------------------------------------------------------------------------
Fitness: 0.3716, Accuracy: 0.3900
Evaluating architecture 5/5... --------------------------------------------------------------------------------
Total Conv Params: 791,136
Total FC Params: 2,102,794

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.4350
Original Complexity Penalty: 2.1375
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0214
Original Fitness: 0.4136
Weighted Complexity Penalty: 1.2734
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0127
Modified Fitness(Weighted Complexity Penalty) : 0.4223
--------------------------------------------------------------------------------
Fitness: 0.4223, Accuracy: 0.4350

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=4, acc=0.4540)

Best overall: Arch(conv=4, acc=0.4540)

Performing roulette-wheel of total population: 5 ...

Roulette-Wheel Selection Probabilities:
Architecture 1: Original Fitness = 0.4413, Shifted Fitness = 0.4413, Probability = 0.2137
Architecture 2: Original Fitness = 0.4273, Shifted Fitness = 0.4273, Probability = 0.2069
Architecture 3: Original Fitness = 0.4223, Shifted Fitness = 0.4223, Probability = 0.2045
Architecture 4: Original Fitness = 0.4030, Shifted Fitness = 0.4030, Probability = 0.1951
Architecture 5: Original Fitness = 0.3716, Shifted Fitness = 0.3716, Probability = 0.1799

Selected 5 architectures using Roulette-Wheel selection
Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=4, acc=0.4540), Arch(conv=4, acc=0.4400), Arch(conv=4, acc=0.0000), Arch(conv=4, acc=0.0000), Arch(conv=4, acc=0.0000)]

============================================================
Generation 3/3
============================================================
Evaluating architecture 1/5... --------------------------------------------------------------------------------
Total Conv Params: 791,136
Total FC Params: 2,102,794

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.4430
Original Complexity Penalty: 2.1375
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0214
Original Fitness: 0.4216
Weighted Complexity Penalty: 1.2734
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0127
Modified Fitness(Weighted Complexity Penalty) : 0.4303
--------------------------------------------------------------------------------
Fitness: 0.4303, Accuracy: 0.4430
Evaluating architecture 2/5... --------------------------------------------------------------------------------
Total Conv Params: 791,136
Total FC Params: 2,102,794

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.4230
Original Complexity Penalty: 2.1375
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0214
Original Fitness: 0.4016
Weighted Complexity Penalty: 1.2734
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0127
Modified Fitness(Weighted Complexity Penalty) : 0.4103
--------------------------------------------------------------------------------
Fitness: 0.4103, Accuracy: 0.4230
Evaluating architecture 3/5... --------------------------------------------------------------------------------
Total Conv Params: 791,136
Total FC Params: 2,102,794

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.4240
Original Complexity Penalty: 2.1375
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0214
Original Fitness: 0.4026
Weighted Complexity Penalty: 1.2734
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0127
Modified Fitness(Weighted Complexity Penalty) : 0.4113
--------------------------------------------------------------------------------
Fitness: 0.4113, Accuracy: 0.4240
Evaluating architecture 4/5... --------------------------------------------------------------------------------
Total Conv Params: 791,136
Total FC Params: 2,102,794

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.4570
Original Complexity Penalty: 2.1375
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0214
Original Fitness: 0.4356
Weighted Complexity Penalty: 1.2734
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0127
Modified Fitness(Weighted Complexity Penalty) : 0.4443
--------------------------------------------------------------------------------
Fitness: 0.4443, Accuracy: 0.4570
Evaluating architecture 5/5... --------------------------------------------------------------------------------
Total Conv Params: 791,136
Total FC Params: 2,102,794

Fitness Analysis:
--------------------------------------------------------------------------------
Accuracy: 0.4330
Original Complexity Penalty: 2.1375
Original Penalty Scale (λ): 0.01
Original Penalty (λ * penalty): 0.0214
Original Fitness: 0.4116
Weighted Complexity Penalty: 1.2734
Penalty Scale (λ): 0.01
Final Penalty (λ * penalty): 0.0127
Modified Fitness(Weighted Complexity Penalty) : 0.4203
--------------------------------------------------------------------------------
Fitness: 0.4203, Accuracy: 0.4330

Sorting population in terms of fitness score (high -> low) ...
Best in generation: Arch(conv=4, acc=0.4570)

Best overall: Arch(conv=4, acc=0.4570)

Performing roulette-wheel of total population: 5 ...

Roulette-Wheel Selection Probabilities:
Architecture 1: Original Fitness = 0.4443, Shifted Fitness = 0.4443, Probability = 0.2099
Architecture 2: Original Fitness = 0.4303, Shifted Fitness = 0.4303, Probability = 0.2033
Architecture 3: Original Fitness = 0.4203, Shifted Fitness = 0.4203, Probability = 0.1986
Architecture 4: Original Fitness = 0.4113, Shifted Fitness = 0.4113, Probability = 0.1943
Architecture 5: Original Fitness = 0.4103, Shifted Fitness = 0.4103, Probability = 0.1939

Selected 5 architectures using Roulette-Wheel selection
Performing Crossover & Mutation ...
Elitism: Keeping top 2 architectures in next generation.
Next Generation: [Arch(conv=4, acc=0.4570), Arch(conv=4, acc=0.4430), Arch(conv=4, acc=0.0000), Arch(conv=4, acc=0.0000), Arch(conv=4, acc=0.0000)]

============================================================
FINAL BEST ARCHITECTURE
============================================================
Genes: {'num_conv': 4, 'conv_configs': [{'filters': 64, 'kernel_size': 7}, {'filters': 16, 'kernel_size': 3}, {'filters': 16, 'kernel_size': 5}, {'filters': 64, 'kernel_size': 3}], 'pool_type': 'avg', 'activation': 'leaky_relu', 'fc_units': 512}
Accuracy: 0.4570
Fitness: 0.4443

Total parameters: 2,137,514

Model architecture:
CNN(
  (features): Sequential(
    (0): Conv2d(3, 64, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): LeakyReLU(negative_slope=0.1, inplace=True)
    (3): Conv2d(64, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (4): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): LeakyReLU(negative_slope=0.1, inplace=True)
    (6): AvgPool2d(kernel_size=2, stride=2, padding=0)
    (7): Conv2d(16, 16, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (8): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): LeakyReLU(negative_slope=0.1, inplace=True)
    (10): Conv2d(16, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (11): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): LeakyReLU(negative_slope=0.1, inplace=True)
    (13): AvgPool2d(kernel_size=2, stride=2, padding=0)
  )
  (classifier): Sequential(
    (0): Flatten(start_dim=1, end_dim=-1)
    (1): Linear(in_features=4096, out_features=512, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.5, inplace=False)
    (4): Linear(in_features=512, out_features=10, bias=True)
  )
)
